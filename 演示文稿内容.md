# CSC207 期末项目汇报内容 - 2025秋季学期

## 小组号：[待填写]

---

## 一、用户故事 (User Stories) - MVP功能概述

**建议时间：1分钟**

### 项目概述：街机游戏平台 (Arcade Game Platform)

我们团队开发了一个基于Java的街机游戏平台，包含以下游戏模块：

### 核心功能列表

| 游戏模块 | 核心功能 | 用户价值 |
|---------|---------|---------|
| **多选题测验** | 分类题目选择、图片题展示、答题反馈、成绩统计 | 帮助用户复习课程知识 |
| **填字游戏** | 图片谜题展示、多答案填写、答案验证 | 提供益智娱乐体验 |
| **连接游戏** | [描述连接游戏功能] | [用户价值] |

### 关键用户故事

1. **作为学生**，我希望能够选择特定模块的题目进行练习，以便有针对性地复习
2. **作为用户**，我希望在答题时获得即时反馈，知道答案是否正确
3. **作为用户**，我希望在完成测验后看到准确率和用时统计
4. **作为玩家**，我希望能够挑战填字游戏来锻炼思维能力

---

## 二、API使用 (API Usage)

**建议时间：30秒**

### 使用的API

| API名称 | 用途 | 实现位置 |
|--------|------|---------|
| **org.json** | 解析JSON格式的题目数据 | `QuestionDAO.java` |
| **Java Swing** | 构建图形用户界面 | `view/` 包下所有视图类 |
| **Java I/O** | 读取资源文件（图片、题目数据） | `data_access/` |

### 数据格式示例

```json
{
  "questionId": "module0_q1",
  "category": "Module 0",
  "imagePath": "data/images/q1.png",
  "correctAnswer": "B"
}
```

---

## 三、数据持久化 (Data Persistence)

**建议时间：30秒**

### 持久化数据类型

| 数据类型 | 存储方式 | 文件位置 |
|---------|---------|---------|
| **题目数据** | JSON文件 | `resources/data/questions.json` |
| **题目图片** | PNG图片资源 | `resources/data/images/` |
| **填字游戏数据** | 本地数据存储 | `LocalCrosswordPuzzleDataAccess` |

### 数据加载流程

```
程序启动 → QuestionDAO.loadData() → 读取JSON文件 → 解析为QuizQuestion对象列表 → 存入内存
```

**演示要点**：在功能演示时展示选择不同模块后加载相应题目的过程

---

## 四、用例演示 (Use Case Walkthrough)

**每位成员约1分钟**

### 4.1 Yihang的用例演示 - 多选题测验模块

#### 用户故事

> 作为一名学生，我希望能够选择特定课程模块的测验题目，并在答题后获得即时反馈，以便有效地进行自我检测。

#### 关注的用例

**开始测验 (Start Quiz) 用例** 和 **提交答案 (Submit Answer) 用例**

#### 界面展示（Before/After Views）

**Before - 类别选择界面 (CategorySelectionView)**
```
┌──────────────────────────────┐
│     Choose a Module          │
├──────────────────────────────┤
│  ○ Module 0                  │
│  ○ Module 1                  │
│  ○ Module 2                  │
│  ○ Module 3                  │
│  ○ Module 4                  │
│  ○ Module 5                  │
├──────────────────────────────┤
│        [  Start  ]           │
└──────────────────────────────┘
```

**After - 测验界面 (QuizView)**
```
┌──────────────────────────────┐
│   ┌────────────────────┐     │
│   │                    │     │
│   │   [题目图片区域]    │     │
│   │                    │     │
│   └────────────────────┘     │
├──────────────────────────────┤
│      Question 1/N            │
├──────────────────────────────┤
│  ┌──────┐    ┌──────┐        │
│  │  A   │    │  B   │        │
│  └──────┘    └──────┘        │
│  ┌──────┐    ┌──────┐        │
│  │  C   │    │  D   │        │
│  └──────┘    └──────┘        │
└──────────────────────────────┘
```

**After - 结果界面 (ResultsView)**
```
┌──────────────────────────────┐
│                              │
│      Quiz Complete!          │
│                              │
│    Accuracy: 85%             │
│    Time: 45.23 seconds       │
│                              │
│        [  Close  ]           │
└──────────────────────────────┘
```

#### UML类图 - 提交答案用例

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Clean Architecture                              │
└─────────────────────────────────────────────────────────────────────────────┘

╔═══════════════════════════════════════════════════════════════════════════╗
║                           Frameworks & Drivers                             ║
║  ┌─────────────────┐                                                       ║
║  │    QuizView     │ (Swing JFrame)                                        ║
║  │  - buttonA~D    │──────────────────────────────────────┐                ║
║  │  - imagePanel   │                                      │                ║
║  └────────┬────────┘                                      │                ║
╚═══════════│═══════════════════════════════════════════════│════════════════╝
            │ actionPerformed()                              │ propertyChange()
            ▼                                                │
╔═══════════════════════════════════════════════════════════│════════════════╗
║                        Interface Adapters                  │                ║
║                                                            │                ║
║  ┌─────────────────┐       ┌─────────────────┐   ┌────────┴────────┐       ║
║  │  QuizController │       │  QuizPresenter  │   │  QuizViewModel  │       ║
║  │                 │       │                 │───│                 │       ║
║  │ +submitAnswer() │       │ +prepareSuccess │   │ +feedbackState  │       ║
║  │ +nextQuestion() │       │ +prepareFail    │   │ +currentImage   │       ║
║  └────────┬────────┘       └────────▲────────┘   └─────────────────┘       ║
╚═══════════│═════════════════════════│══════════════════════════════════════╝
            │                         │
            ▼                         │ implements
╔═══════════════════════════════════════════════════════════════════════════╗
║                            Use Cases (Application)                         ║
║                                                                            ║
║  ┌─────────────────────────┐        ┌────────────────────────────────┐    ║
║  │ «interface»              │        │ «interface»                    │    ║
║  │SubmitAnswerInputBoundary│        │SubmitAnswerOutputBoundary      │    ║
║  └────────────┬─────────────┘        └────────────────────────────────┘    ║
║               │                                    ▲                       ║
║               ▼                                    │                       ║
║  ┌─────────────────────────────────────────────────┴──────────────────┐   ║
║  │              SubmitAnswerInteractor                                 │   ║
║  │  - quizSession: QuizSession                                         │   ║
║  │  + execute(SubmitAnswerInputData)                                   │   ║
║  │  + advance()                                                        │   ║
║  └─────────────────────────────────┬──────────────────────────────────┘   ║
╚════════════════════════════════════│══════════════════════════════════════╝
                                     │
                                     ▼
╔═══════════════════════════════════════════════════════════════════════════╗
║                             Entities (Core)                                ║
║                                                                            ║
║  ┌─────────────────────────┐    ┌─────────────────────────────────┐       ║
║  │     QuizQuestion        │    │         QuizSession             │       ║
║  │  - questionId           │◄───│  - questions: List<QuizQuestion>│       ║
║  │  - imagePath            │    │  - currentQuestionIndex         │       ║
║  │  - category             │    │  - correctAnswersCount          │       ║
║  │  - correctAnswer        │    │  + recordAnswer(boolean)        │       ║
║  └─────────────────────────┘    │  + advanceToNextQuestion()      │       ║
║                                  │  + getAccuracy()                │       ║
║                                  └─────────────────────────────────┘       ║
╚═══════════════════════════════════════════════════════════════════════════╝
```

#### Use Case Interactor 代码展示

```java
public class SubmitAnswerInteractor implements SubmitAnswerInputBoundary {
    
    private final QuizSession quizSession;
    private final SubmitAnswerOutputBoundary submitAnswerPresenter;
    private final QuizOutputBoundary quizPresenter;

    public SubmitAnswerInteractor(QuizSession quizSession,
                                   SubmitAnswerOutputBoundary submitAnswerPresenter,
                                   QuizOutputBoundary quizPresenter) {
        this.quizSession = quizSession;
        this.submitAnswerPresenter = submitAnswerPresenter;
        this.quizPresenter = quizPresenter;
    }

    @Override
    public void execute(SubmitAnswerInputData inputData) {
        // 1. 获取用户答案
        String selectedAnswer = inputData.getSelectedAnswer();
        
        // 2. 获取当前问题的正确答案
        QuizQuestion currentQuestion = quizSession.getCurrentQuestion();
        String correctAnswer = currentQuestion.getCorrectAnswer();
        
        // 3. 判断是否正确
        boolean isCorrect = selectedAnswer.equals(correctAnswer);
        
        // 4. 记录答案
        quizSession.recordAnswer(isCorrect);
        
        // 5. 创建输出数据
        SubmitAnswerOutputData outputData = new SubmitAnswerOutputData(
            isCorrect, selectedAnswer, correctAnswer
        );
        
        // 6. 调用Presenter
        if (isCorrect) {
            submitAnswerPresenter.prepareSuccessView(outputData);
        } else {
            submitAnswerPresenter.prepareFailView(outputData);
        }
    }

    public void advance() {
        // 答对后调用，进入下一题或显示结果
        boolean hasMore = quizSession.advanceToNextQuestion();
        
        if (hasMore) {
            // 加载下一题
            QuizQuestion next = quizSession.getCurrentQuestion();
            QuizOutputData outputData = new QuizOutputData(
                next.getImagePath(),
                String.format("Question %d/%d", 
                    quizSession.getCurrentIndex() + 1,
                    quizSession.getTotalQuestions())
            );
            quizPresenter.prepareQuizView(outputData);
        } else {
            // 测验结束，显示结果
            quizSession.finishQuiz();
            submitAnswerPresenter.prepareResultsView(
                quizSession.getAccuracy(),
                quizSession.getTotalTime()
            );
        }
    }
}
```

#### 控制流程说明

```
1. 用户点击答案按钮 (A/B/C/D)
                ↓
2. QuizView 调用 controller.submitAnswer("A")
                ↓
3. QuizController 创建 SubmitAnswerInputData 对象
                ↓
4. SubmitAnswerInteractor.execute() 被调用
   - 获取用户答案和正确答案
   - 调用 quizSession.recordAnswer() 记录结果
   - 创建 SubmitAnswerOutputData
                ↓
5. 如果正确: Presenter.prepareSuccessView()
   如果错误: Presenter.prepareFailView()
                ↓
6. Presenter 更新 QuizViewModel
   - setFeedbackState("CORRECT" 或 "INCORRECT")
   - setIncorrectButton(选中的按钮)
                ↓
7. QuizView.propertyChange() 被触发
   - 按钮变色 (绿色=正确, 红色=错误)
                ↓
8. 如果正确，启动1秒Timer后调用 controller.nextQuestion()
                ↓
9. SubmitAnswerInteractor.advance() 加载下一题或显示结果
```

### 4.2 [其他团队成员的用例演示]

*请其他团队成员按照相同格式添加各自负责模块的用例演示*

---

## 五、设计 (Design)

**建议时间：2.5分钟**

### 5.1 SOLID原则遵循

#### 示例1：单一职责原则 (SRP) - SubmitAnswerInteractor

```java
// SubmitAnswerInteractor 只负责处理答案提交的业务逻辑
// 不负责：UI更新、数据存储、视图切换

public class SubmitAnswerInteractor implements SubmitAnswerInputBoundary {
    // 职责单一：验证答案、记录结果、通知Presenter
    public void execute(SubmitAnswerInputData inputData) { ... }
    public void advance() { ... }
}
```

**说明**：每个类只有一个变化的理由
- `SubmitAnswerInteractor`: 只处理答案提交逻辑
- `QuizPresenter`: 只负责格式化输出数据
- `QuizViewModel`: 只负责存储视图状态

#### 示例2：依赖倒置原则 (DIP) - QuestionDAI接口

```java
// 用例层定义接口（高层模块不依赖低层模块）
public interface QuestionDAI {
    void loadData();
    List<QuizQuestion> getCategorizedQuestions(String category);
}

// 数据访问层实现接口（低层模块依赖抽象）
public class QuestionDAO implements QuestionDAI {
    // 具体实现JSON文件读取
}
```

```
┌─────────────────────────────────────────────────────────┐
│                      Use Case Layer                      │
│  ┌─────────────────┐      ┌─────────────────────────┐   │
│  │  QuizInteractor │─────▶│ «interface» QuestionDAI │   │
│  └─────────────────┘      └───────────▲─────────────┘   │
└───────────────────────────────────────│─────────────────┘
                                        │ implements
┌───────────────────────────────────────│─────────────────┐
│                    Data Access Layer   │                 │
│                          ┌─────────────┴─────────────┐  │
│                          │      QuestionDAO          │  │
│                          │   (JSON文件读取实现)       │  │
│                          └───────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

### 5.2 Clean Architecture遵循

**依赖规则**：外层依赖内层，内层不知道外层

```
Frameworks & Drivers  →  Interface Adapters  →  Use Cases  →  Entities
    (View层)               (Controller层)      (Interactor)   (核心实体)
    
✓ QuizView 知道 QuizController
✓ QuizController 知道 QuizInteractor
✓ QuizInteractor 知道 QuizSession, QuizQuestion
✗ QuizSession 不知道任何外层类
```

### 5.3 设计模式使用

#### 观察者模式 (Observer Pattern) - ViewModel通知机制

**实现位置**：`QuizViewModel` ↔ `QuizView`

```java
// QuizViewModel 作为 Subject
public class QuizViewModel extends PropertyChangeSupport {
    private String feedbackState;
    
    public void setFeedbackState(String state) {
        String old = this.feedbackState;
        this.feedbackState = state;
        // 通知所有Observer
        firePropertyChange("feedbackState", old, state);
    }
}

// QuizView 作为 Observer
public class QuizView extends JFrame implements PropertyChangeListener {
    
    public QuizView(QuizController controller, QuizViewModel viewModel) {
        // 注册为Observer
        viewModel.addPropertyChangeListener(this);
    }
    
    @Override
    public void propertyChange(PropertyChangeEvent evt) {
        if ("feedbackState".equals(evt.getPropertyName())) {
            handleFeedbackState();
        }
    }
}
```

**设计优势**：
- View和Model解耦
- 支持多个Observer
- 自动UI更新

#### 边界对象模式 (Boundary Pattern)

```
┌───────────────────────────────────────────────────────────┐
│                                                           │
│  InputBoundary  ←────  Controller                         │
│       ↓                                                   │
│  Interactor                                               │
│       ↓                                                   │
│  OutputBoundary ←────  Presenter                          │
│                                                           │
└───────────────────────────────────────────────────────────┘
```

**这是我们团队引入的设计模式，不是starter code自带的**

---

## 六、功能演示 (Functionality Demonstration)

**建议时间：3.5分钟**

### 演示流程

1. **启动应用**
   - 显示类别选择界面

2. **选择模块**
   - 选择 Module 0
   - 点击 Start 按钮

3. **答题演示**
   - 展示题目图片加载
   - 点击正确答案 → 按钮变绿 → 自动进入下一题
   - 点击错误答案 → 按钮变红 → 可继续选择

4. **完成测验**
   - 展示结果界面
   - 显示准确率和用时

5. **填字游戏演示** *(如时间允许)*
   - 加载谜题
   - 填写答案
   - 验证结果

### 演示要点

- ✅ 即时反馈机制（颜色变化）
- ✅ 进度显示 "Question X/N"
- ✅ 计时功能
- ✅ 准确率计算
- ✅ 数据持久化（题目从JSON加载）

---

## 七、代码组织 (Code Organization)

**建议时间：30秒**

### 包结构 - 多选题模块 (Multiple_Choice_Yihang2)

```
src/main/java/com/csc207/arcade/multiplechoice/
├── app/                          # 应用层 - 程序入口和依赖注入
│   └── Main.java
├── entities/                     # 实体层 - 核心业务对象
│   ├── QuizQuestion.java
│   └── QuizSession.java
├── use_case/                     # 用例层 - 应用业务逻辑
│   ├── QuestionDAI.java          # 数据访问接口
│   ├── quiz/                     # 开始测验用例
│   │   ├── QuizInputBoundary.java
│   │   ├── QuizInputData.java
│   │   ├── QuizOutputBoundary.java
│   │   ├── QuizOutputData.java
│   │   └── QuizInteractor.java
│   └── submit/                   # 提交答案用例
│       └── ...
├── interface_adapter/            # 接口适配器层
│   ├── QuizController.java
│   ├── QuizPresenter.java
│   ├── QuizViewModel.java
│   └── ResultsViewModel.java
├── data_access/                  # 数据访问实现
│   └── QuestionDAO.java
└── view/                         # 视图层
    ├── CategorySelectionView.java
    ├── QuizView.java
    ├── ResultsView.java
    └── ScaledImagePanel.java
```

### 命名规范

- 包名：全小写，下划线分隔 (`use_case`, `interface_adapter`)
- 类名：PascalCase (`QuizInteractor`, `SubmitAnswerOutputData`)
- 接口：描述性命名 (`InputBoundary`, `OutputBoundary`, `DAI`)

---

## 八、代码质量 (Code Quality)

**建议时间：30秒**

### 代码质量保障措施

1. **代码审查流程**
   - 所有更改通过Pull Request提交
   - 至少一人审查后才能合并
   - 代表性PR: [填写PR链接]

2. **分支策略**
   - `main` - 稳定版本
   - `Multiple_Choice_Yihang2` - Yihang的多选题模块
   - `Crossword_Backend_MVP_Petru` - 填字游戏后端
   - 每个功能独立分支开发

3. **代码风格**
   - 遵循Java命名规范
   - 适当的代码注释
   - 清晰的职责分离

### 代表性Pull Request

*[填写PR链接和简要说明]*

展示内容：
- PR描述完整
- 代码审查讨论
- 测试验证

---

## 九、Yihang在Multiple_Choice_Yihang2分支的主要贡献

### 新增功能

| 功能 | 描述 | 影响 |
|------|------|------|
| **类别选择界面** | 新增CategorySelectionView | 用户可选择特定模块 |
| **分类题目加载** | 按Module 0-5分类加载 | 更灵活的学习方式 |
| **即时反馈机制** | 答案正确/错误颜色反馈 | 提升用户体验 |
| **自动前进功能** | 答对后1秒自动下一题 | 流畅的答题体验 |

### 架构改进

| 改动类型 | Before (Jiayi) | After (Yihang) |
|---------|----------------|----------------|
| 应用启动 | AppBuilder模式 | 直接依赖注入 |
| 数据访问 | JsonQuestionRepository | QuestionDAO |
| Main类 | 约122行，复杂 | 约65行，清晰 |
| Interactor注入 | 构造时全部注入 | 延迟注入模式 |

### 代码简化

- 删除 `AppBuilder.java` (复杂的构建器)
- 删除 `DataInitializer.java` (不必要的初始化工具)
- 重构数据访问接口命名 (`QuestionRepository` → `QuestionDAI`)

### Clean Architecture遵循度提升

- ✅ 更清晰的层次划分
- ✅ 减少不必要的抽象
- ✅ 依赖规则严格遵守
- ✅ 接口命名更规范

---

## 十、总结

### 项目亮点

1. **严格的Clean Architecture实现** - 四层架构清晰分离
2. **SOLID原则贯穿始终** - 单一职责、依赖倒置等
3. **观察者模式的优雅应用** - ViewModel驱动UI更新
4. **良好的用户体验** - 即时反馈、自动前进
5. **可扩展的设计** - 易于添加新游戏模块

### 技术栈

- **语言**: Java 11+
- **UI框架**: Swing
- **构建工具**: Maven
- **数据格式**: JSON
- **设计模式**: Clean Architecture, Observer, Boundary, DAO

---

## 附录：快速参考

### Yihang演示时可以强调的点

1. "这是我新增的类别选择功能，让用户可以针对性地练习"
2. "我重构了数据访问层，使用QuestionDAI接口实现依赖倒置"
3. "Main类从122行简化到65行，代码更清晰"
4. "观察者模式实现了View和Model的解耦"
5. "提交答案用例展示了完整的Clean Architecture数据流"

### 可能的问题及回答

**Q: 为什么选择延迟注入SubmitAnswerInteractor？**
> A: 因为SubmitAnswerInteractor需要QuizSession对象，而QuizSession是在用户选择类别后才创建的。延迟注入让依赖创建时机更合理。

**Q: 如何保证代码符合Clean Architecture？**
> A: 通过接口隔离层间依赖，内层定义接口，外层实现。实体层(QuizQuestion, QuizSession)不依赖任何外层类。

**Q: 观察者模式带来了什么好处？**
> A: View不需要主动轮询ViewModel的状态变化，当数据更新时自动接收通知并刷新UI，实现了松耦合。

---

*文档版本: 1.0*  
*基于分支: Multiple_Choice_Yihang2*  
*准备日期: 2024*
